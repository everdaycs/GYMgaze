# 训练扩散模型所需额外依赖

## PyTorch（深度学习框架）

```bash
# CPU版本（轻量，适合测试）
pip install torch torchvision torchaudio

# CUDA 11.8版本（推荐，如果有NVIDIA GPU）
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118

# CUDA 12.1版本（最新）
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121

# macOS（Apple Silicon）
pip install torch torchvision torchaudio
```

## 其他依赖

```bash
# 进度条
pip install tqdm

# 绘图（如果还没有）
pip install matplotlib

# 机器学习工具（评估指标）
pip install scikit-learn

# 可选：TensorBoard（训练可视化）
pip install tensorboard
```

## 完整安装命令

```bash
# 创建requirements_training.txt
cat > requirements_training.txt << EOF
torch>=2.0.0
torchvision>=0.15.0
torchaudio>=2.0.0
tqdm>=4.65.0
matplotlib>=3.7.0
scikit-learn>=1.3.0
tensorboard>=2.13.0
EOF

# 安装
pip install -r requirements_training.txt
```

## 验证安装

```python
import torch
import torchvision
from tqdm import tqdm
import matplotlib.pyplot as plt
from sklearn.metrics import accuracy_score

print(f"PyTorch版本: {torch.__version__}")
print(f"CUDA可用: {torch.cuda.is_available()}")
if torch.cuda.is_available():
    print(f"CUDA版本: {torch.version.cuda}")
    print(f"GPU数量: {torch.cuda.device_count()}")
    print(f"GPU名称: {torch.cuda.get_device_name(0)}")
```

## 注意事项

1. **如果不训练学习模型**，这些依赖不是必需的
2. **规则模型**（当前实现）不需要PyTorch
3. **训练需要较长时间**，建议使用GPU
4. **数据收集**可以在CPU上运行，但训练最好用GPU
